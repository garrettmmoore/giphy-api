<!DOCTYPE html>
<html>
<head>
	<title>Giphy Time!</title>
	<!-- BootStrap CDN -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
</head>
	<body>
		<div class = "container">
			<div class = "row">
				<div class = "col-md-12">
					<div id = "title-box">
						<h1>Video Game Gif Generator</h1>
					</div>
				</div>
			</div>
			<div class = "row">
				<div class = "col-md-8">
					<div id = "buttons-view">
					</div>
				</div>
				<div class = "col-md-4">
					<form id="video-game-form">
	      				<label for="video-game-input">Add a Video Game</label>
	      				<input type="text" id="video-game-input"><br>
	      				<!-- Button triggers new video game to be added -->
	      				<input id="add-video-game" type="submit" value="Add a Video Game">
	    			</form>
				</div>
			</div>
			<div class = "row">
				<div class = "col-md-12">
					<div id="video-game-view">
					</div>
				</div>

			</div>
		</div>

		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<script type="text/javascript">
			// Initial array of video games
			var videoGames = ["Overwatch", "Halo", "Super Smash Brothers", "The Legend of Zelda"];

			// displayVideoGameInfo function re-renders the HTML to display the appropriate content
			function displayVideoGameInfo() {
				var game = $(this).attr("data-name");
		      	var queryURL = "http://api.giphy.com/v1/gifs/search?q=" + game + "&api_key=ca85b3600e244eb399b02146bb569377&limit=10";

		      	$.ajax({
          			url: queryURL,
          			method: "GET"
        			})

		      		.done(function(response) {
		      			console.log(queryURL);
        				console.log(response);

        			// clear the contents
        			$("#video-game-view").empty();

		          	var results = response.data;

	          		// Looping through each result item
			          for (var i = 0; i < results.length; i++) {

		            	// Creating and storing a div tag
		            	var videoGameDiv = $("<div class='game'>");

		            	// Creating a paragraph tag with the result item's rating
						var p = $("<p>").text("Rating: " + results[i].rating);

			            // Creating and storing an image tag
			            var gameImage = $('<img class="gif" src="' + results[i].images.fixed_height.url + '">');
			            // Setting the src attribute of the image to a property pulled off the result item
			            // gameImage.attr("src", results[i].images.fixed_height_still.url);

			            // Appending the paragraph and image tag to the videoGameDiv
			            videoGameDiv.append(p);
			            videoGameDiv.append(gameImage);

			            // Prependng the videoGameDiv to the HTML page in the "#gifs-appear-here" div
			            $("#video-game-view").append(videoGameDiv);


			          }

		          });

			}

	     	// Function for displaying movie data
			function renderButtons() {

				// Deleting the movies prior to adding new movies
				// (this is necessary otherwise you will have repeat buttons)
				$("#buttons-view").empty();

				// Looping through the array of videoGames
				for (var i = 0; i < videoGames.length; i++) {

				  // Then dynamicaly generating buttons for each movie in the array
				  // This code $("<button>") is all jQuery needs to create the beginning and end tag. (<button></button>)
				  var a = $("<button>");
				  // Adding a class of movie to our button
				  a.addClass("game");
				  // Adding a data-attribute
				  a.attr("data-name", videoGames[i]);
				  // Providing the initial button text
				  a.text(videoGames[i]);
				  // Adding the button to the buttons-view div
				  $("#buttons-view").append(a);
				}
			}

			// This function handles events where a video game button is clicked
			$("#add-video-game").on("click", function(event) {
			event.preventDefault();
			// This line grabs the input from the textbox
			var game = $("#video-game-input").val().trim();

			// Adding movie from the textbox to our array
			videoGames.push(game);

			// Calling renderButtons which handles the processing of our videoGames array
			renderButtons();
			});

			// Adding a click event listener to all elements with a class of "game"
			$(document).on("click", ".game", displayVideoGameInfo);

			// Calling the renderButtons function to display the intial buttons
			renderButtons();

						// This functions handles events where a gif is clicked


		

		</script>

	</body>
</html>